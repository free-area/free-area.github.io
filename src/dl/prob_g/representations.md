```

headerDepth: 2
sidebar: heading

```



# æ¨¡å‹è¡¨ç¤º

å›¾ç”±ä¸€ç»„èŠ‚ç‚¹å’ŒèŠ‚ç‚¹ä¹‹é—´çš„è¾¹ç»„æˆï¼åœ¨æ¦‚ç‡å›¾æ¨¡å‹ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºä¸€ä¸ª==éšæœºå˜é‡ï¼ˆæˆ–ä¸€ç»„éšæœºå˜é‡ï¼‰==ï¼Œè¾¹è¡¨ç¤ºè¿™äº›éšæœºå˜é‡ä¹‹é—´çš„==æ¦‚ç‡ä¾èµ–å…³ç³»==ï¼

å¸¸è§çš„æ¦‚ç‡å›¾æ¨¡å‹å¯ä»¥åˆ†ä¸ºä¸¤ç±»: ==æœ‰å‘å›¾æ¨¡å‹==å’Œ==æ— å‘å›¾æ¨¡å‹==.

1. æœ‰å‘å›¾æ¨¡å‹ä½¿ç”¨æœ‰å‘éå¾ªç¯å›¾ (Directed Acyclic Graph, DAG) æ¥æè¿°å˜é‡ä¹‹é—´çš„å…³ç³». å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´æœ‰è¿è¾¹, è¡¨ç¤ºå¯¹åº”çš„ä¸¤ä¸ªå˜é‡ä¸ºå› æœå…³ç³»,å³ä¸å­˜åœ¨å…¶ä»–å˜é‡ä½¿å¾—è¿™ä¸¤ä¸ªèŠ‚ç‚¹å¯¹åº”çš„å˜ é‡æ¡ä»¶ç‹¬ç«‹.
2.  æ— å‘å›¾æ¨¡å‹ä½¿ç”¨æ— å‘å›¾ (Undirected Graph) æ¥æè¿°å˜é‡ä¹‹é—´çš„å…³ç³».æ¯æ¡è¾¹ä»£è¡¨ä¸¤ä¸ªå˜é‡ä¹‹é—´æœ‰æ¦‚ç‡ä¾èµ–å…³ç³», ä½†æ˜¯å¹¶ä¸ä¸€å®šæ˜¯å› æœå…³ç³».

å›¾1ç»™å‡ºäº†ä¸¤ä¸ªä»£è¡¨æ€§å›¾æ¨¡å‹ (æœ‰å‘å›¾å’Œæ— å‘å›¾) çš„ç¤ºä¾‹, åˆ†åˆ«è¡¨ç¤ºäº†å››ä¸ªå˜é‡ $\left\{X_1, X_2, X_3, X_4\right\}$ ä¹‹é—´çš„ä¾èµ–å…³ç³». ==å›¾ä¸­å¸¦é˜´å½±çš„èŠ‚ç‚¹è¡¨ç¤ºå¯è§‚æµ‹åˆ°çš„å˜é‡, ä¸å¸¦é˜´å½±çš„èŠ‚ç‚¹è¡¨ç¤ºéšå˜é‡==,è¿è¾¹è¡¨ç¤ºä¸¤å˜é‡é—´çš„æ¡ä»¶ä¾èµ–å…³ç³».

![æœ‰å‘å›¾å’Œæ— å‘å›¾ç¤ºä¾‹](.assets/image-20231215223223576.png)

## **æœ‰å‘å›¾æ¨¡å‹**

==æœ‰å‘å›¾æ¨¡å‹==ï¼ˆDirected Graphical Modelï¼‰ï¼Œä¹Ÿç§°ä¸º==è´å¶æ–¯ç½‘ç»œ==ï¼ˆBayesianNetworkï¼‰æˆ–==ä¿¡å¿µç½‘ç»œ==ï¼ˆBelief Networkï¼ŒBNï¼‰ï¼Œæ˜¯ä¸€ç±»ç”¨æœ‰å‘å›¾æ¥æè¿°éšæœºå‘é‡æ¦‚ç‡åˆ†å¸ƒçš„æ¨¡å‹ï¼

ä¸‹å›¾ä¸­ $x_j$è¡¨ç¤º $x_i$ çš„çˆ¶ç±»ï¼š

![img](.assets/v2-a3ec43f73839d39218a1c7c384d639db_1440w-1702707902605-1.webp)

::: info å®šä¹‰ï¼ˆè´å¶æ–¯ç½‘ç»œï¼‰

å¯¹äºä¸€ä¸ª $K$ ç»´éšæœºå‘é‡ $\boldsymbol{X}$ å’Œä¸€ä¸ªæœ‰ $K$ ä¸ªèŠ‚ç‚¹çš„æœ‰å‘éå¾ªç¯å›¾ $G, G$ ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯¹åº”ä¸€ä¸ªéšæœºå˜é‡, æ¯ä¸ªè¿æ¥ $e_{i j}$ è¡¨ç¤ºä¸¤ä¸ªéšæœºå˜é‡ $X_i$ å’Œ $X_j$ ä¹‹é—´å…·æœ‰éç‹¬ç«‹çš„å› æœå…³ç³». ä»¤ $\boldsymbol{X}_{\pi_k}$ è¡¨ç¤ºå˜é‡ $X_k$ çš„æ‰€æœ‰çˆ¶èŠ‚ç‚¹å˜é‡é›†åˆ, $P\left(X_k \mid \boldsymbol{X}_{\pi_k}\right)$ è¡¨ç¤ºæ¯ä¸ªéšæœºå˜é‡çš„å±€éƒ¨æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ ( Local Conditional Probability Distribution). å¦‚æœ $\boldsymbol{X}$ çš„è”åˆæ¦‚ç‡åˆ†å¸ƒå¯ä»¥åˆ†è§£ä¸ºæ¯ä¸ªéšæœºå˜é‡ $X_k$ çš„å±€éƒ¨æ¡ä»¶æ¦‚ç‡çš„è¿ä¹˜å½¢å¼, å³
$$
p(\boldsymbol{x})=\prod_{k=1}^K p\left(x_k \mid \boldsymbol{x}_{\pi_k}\right),
$$

é‚£ä¹ˆ $(G, \boldsymbol{X})$ æ„æˆäº†ä¸€ä¸ªè´å¶æ–¯ç½‘ç»œ.

:::

å› æ­¤å¯ä»¥æ ¹æ®æœ‰å‘å›¾å†™å‡ºå› å­åˆ†è§£çš„ç»“æœã€‚ä»¥ä¸‹ï¼Œæœ‰ä¸‰ç§æƒ…å†µï¼š

1. **å…±å› å…³ç³»ï¼ˆtail2tailï¼‰**

![img](.assets/v2-579148c4131bc03e99c5978de9aac985_1440w.webp)

å¯ä»¥å†™å‡ºå…¶å› å­åˆ†è§£çš„ç»“æœï¼š
$$
P(a, b, c)=P(a) P(b \mid a) P(c \mid a)
$$

åŒæ—¶æˆ‘ä»¬å¯ä»¥æ ¹æ®é“¾å¼æ³•åˆ™å†™å‡ºè”åˆæ¦‚ç‡:
$$
P(a, b, c)=P(a) P(b \mid a) P(c \mid a, b)
$$

å› æ­¤:
$$
\begin{aligned}
P(a) P(b \mid a) P(c \mid a) & =P(a) P(b \mid a) P(c \mid a, b) \\
P(c \mid a) & =P(c \mid a, b) \\
P(c \mid a) P(b \mid a) & =P(c \mid a, b) P(b \mid a) \\
P(c \mid a) P(b \mid a) & =P(b, c \mid a)
\end{aligned}
$$

æ‰€ä»¥å¯çŸ¥: $b$ ä¸ $c$ ç‹¬ç«‹ (åœ¨ $a$ å·²çŸ¥çš„æ¡ä»¶ä¸‹)

è‹¥ $a$ è¢«è§‚æµ‹ï¼Œåˆ™è·¯å¾„è¢«å µå¡ï¼Œå³ $b$ ä¸ $c$ ç‹¬ç«‹ $c \perp b \mid a$

![image-20231216143312896](.assets/image-20231216143312896.png)

::: warning

æ­¤è§„åˆ™å¹¶ä¸æ˜¯å¼ºåŠ ä¸Šå»çš„ï¼Œæ˜¯æˆ‘ä»¬ç”¨æ¦‚ç‡å›¾çš„å› å­åˆ†è§£è¡¨ç¤ºè”åˆæ¦‚ç‡åï¼Œæœ¬èº«å­˜åœ¨çš„ç°è±¡ï¼Œæˆ‘ä»¬åœ¨è¯æ˜æ­¤ç°è±¡å­˜åœ¨åï¼Œæ€»ç»“å‡ºçš„è§„å¾‹ï¼Œæ ¹æ®æ­¤è§„å¾‹å¯ä»¥ç›´æ¥çœ‹å›¾å¾—å‡ºç»“è®ºã€‚

:::

2. **é—´æ¥å› æœå…³ç³»ï¼ˆhead2tailï¼‰**

![img](.assets/v2-48e2c301e9d1974fa3fe35aba6f7c2da_1440w.webp)

å¦‚å›¾å¯ä»¥å†™å‡ºå…¶å› å­åˆ†è§£çš„ç»“æœï¼š
$$
P(a, b, c)=P(a) P(b \mid a) P(c \mid b)
$$

åŒæ—¶æˆ‘ä»¬å¯ä»¥æ ¹æ®é“¾å¼æ³•åˆ™å†™å‡ºè”åˆæ¦‚ç‡:
$$
P(a, b, c)=P(a) P(b \mid a) P(c \mid a, b)
$$

å› æ­¤:
$$
\begin{aligned}
P(a) P(b \mid a) P(c \mid b) & =P(a) P(b \mid a) P(c \mid a, b) \\
P(c \mid b) & =P(c \mid a, b) \\
P(c \mid b) P(a \mid b) & =P(c \mid a, b) P(a \mid b) \\
P(c \mid b) P(a \mid b) & =P(a, c \mid b)
\end{aligned}
$$

æ‰€ä»¥å¯çŸ¥ï¼š $a$ ä¸ $c$ ç‹¬ç«‹ (åœ¨ $b$ å·²çŸ¥çš„æ¡ä»¶ä¸‹) ä» $b$ çš„è§’åº¦æ¥çœ‹ï¼Œæ˜¯ $a$ çš„å¤´å’Œ $c$ çš„å°¾å·´ç›¸è¿ï¼Œæ‰€ä»¥ç§°ä¸ºhead-to-tail

![image-20231216143808424](.assets/image-20231216143808424.png)

3. **å…±æœå…³ç³»ï¼ˆhead2head)**

![img](.assets/v2-2e7f3a8d2ca06804c63fc029304689a0_1440w.webp)

å¦‚å›¾å¯ä»¥å†™å‡ºå…¶å› å­åˆ†è§£çš„ç»“æœ:
$$
P(a, b, c)=P(a) P(b) P(c \mid a, b)
$$

åŒæ—¶æˆ‘ä»¬å¯ä»¥æ ¹æ®é“¾å¼æ³•åˆ™å†™å‡ºè”åˆæ¦‚ç‡:
$$
P(a, b, c)=P(a) P(b \mid a) P(c \mid a, b)
$$

å› æ­¤:
$$
\begin{aligned}
P(a) P(b) P(c \mid a, b) & =P(a) P(b \mid a) P(c \mid a, b) \\
P(b) & =P(b \mid a) \\
P(b) P(a) & =P(b \mid a) P(a) \\
P(a) P(b) & =P(a, b)
\end{aligned}
$$

æ‰€ä»¥å¯çŸ¥: $a$ ä¸ $b$ ç‹¬ç«‹ (åœ¨ $c$ ä¸çŸ¥çš„æƒ…å†µä¸‹)

ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“ä¸€ä¸ªè§„å¾‹ï¼š

ä» $c$ çš„è§’åº¦æ¥çœ‹ï¼Œæ˜¯ $a$ çš„å¤´å’Œ $b$ çš„å¤´ç›¸è¿ï¼Œæ‰€ä»¥ç§°ä¸ºhead-to-head é»˜è®¤æƒ…å†µä¸‹ï¼Œ $a \perp b$ ï¼Œè·¯å¾„æ˜¯é˜»å¡çš„

ç‰¹æ®Šæƒ…å†µï¼šè‹¥ $c$ è¢«è§‚æµ‹ï¼Œåˆ™è·¯å¾„æ˜¯é€šçš„ï¼Œ $a$ å’Œ $b$ ä¸ç‹¬ç«‹

è¿™ç§æƒ…å†µä¸­ï¼Œåœ¨ç»™å®š $c$ æ—¶ï¼Œ $a$ å’Œ $b$ åè€Œä¸ç‹¬ç«‹äº†ï¼Œä¸å‰ä¸¤ç§æƒ…å†µåˆšå¥½ç›¸åï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹:

::: important å±€éƒ¨é©¬å°”å¯å¤«æ€§è´¨

å±€éƒ¨é©¬å°”å¯å¤«æ€§è´¨ å¯¹ä¸€ä¸ªæ›´ä¸€èˆ¬çš„è´å¶æ–¯ç½‘ç»œ, å…¶å±€éƒ¨é©¬å°”å¯å¤«æ€§è´¨ä¸º: æ¯ä¸ªéšæœºå˜é‡åœ¨ç»™å®šçˆ¶èŠ‚ç‚¹çš„æƒ…å†µä¸‹, æ¡ä»¶ç‹¬ç«‹äºå®ƒçš„éåä»£èŠ‚ç‚¹.
$$
X_k \perp Z \mid X_{\pi_k},
$$

å…¶ä¸­ $Z$ ä¸º $X_k$ çš„éåä»£å˜é‡.

:::





## å¸¸è§çš„æœ‰å‘å›¾æ¨¡å‹

å¾ˆå¤šç»å…¸çš„æœºå™¨å­¦ä¹ æ¨¡å‹å¯ä»¥ä½¿ç”¨æœ‰å‘å›¾æ¨¡å‹æ¥æè¿°ï¼Œæ¯”å¦‚æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ã€éšé©¬å°”å¯å¤«æ¨¡å‹ã€æ·±åº¦ä¿¡å¿µç½‘ç»œç­‰ï¼

### Sigmoidä¿¡å¿µç½‘ç»œ

ä¸ºäº†å‡å°‘æ¨¡å‹å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨==å‚æ•°åŒ–æ¨¡å‹==æ¥å»ºæ¨¡æœ‰å‘å›¾æ¨¡å‹ä¸­çš„==æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ==ï¼ä¸€ç§ç®€å•çš„å‚æ•°åŒ–æ¨¡å‹ä¸ºSigmoidä¿¡å¿µç½‘ç»œ[^1]

==Sigmoid ä¿¡å¿µç½‘ç»œ== (Sigmoid Belief Network, SBN) ä¸­çš„å˜é‡å–å€¼ä¸º $\{0,1\}$.å¯¹äºå˜é‡ $X_k$ å’Œå®ƒçš„çˆ¶èŠ‚ç‚¹é›†åˆ $\pi_k$, å…¶æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒè¡¨ç¤ºä¸º
$$
p\left(x_k=1 \mid \boldsymbol{x}_{\pi_k} ; \theta\right)=\sigma\left(\theta_0+\sum_{x_i \in x_{\pi_k}} \theta_i x_i\right),
$$

å…¶ä¸­ $\sigma(\cdot)$ æ˜¯ Logistic å‡½æ•°, $\theta_i$ æ˜¯å¯å­¦ä¹ çš„å‚æ•°. å‡è®¾å˜é‡ $X_k$ çš„çˆ¶èŠ‚ç‚¹æ•°é‡ä¸º $M$,å¦‚æœä½¿ç”¨è¡¨æ ¼æ¥è®°å½•æ¡ä»¶æ¦‚ç‡éœ€è¦ $2^M$ ä¸ªå‚æ•°, å¦‚æœä½¿ç”¨å‚æ•°åŒ–æ¨¡å‹åªéœ€è¦ $M+$ 1 ä¸ªå‚æ•°. å¦‚æœå¯¹ä¸åŒçš„å˜é‡çš„æ¡ä»¶æ¦‚ç‡éƒ½å…±äº«ä½¿ç”¨ä¸€ä¸ªå‚æ•°åŒ–æ¨¡å‹, å…¶å‚æ•°æ•°é‡åˆå¯ä»¥å¤§å¹…å‡å°‘.

å€¼å¾—ä¸€æçš„æ˜¯, Sigmoid ä¿¡å¿µç½‘ç»œä¸ Logistic å›å½’æ¨¡å‹éƒ½é‡‡ç”¨ Logistic å‡½æ•°æ¥è®¡ç®—æ¡ä»¶æ¦‚ç‡. å¦‚æœå‡è®¾ Sigmoid ä¿¡å¿µç½‘ç»œä¸­åªæœ‰ä¸€ä¸ªå¶å­èŠ‚ç‚¹, å…¶æ‰€æœ‰çš„çˆ¶èŠ‚ç‚¹ä¹‹é—´æ²¡æœ‰è¿æ¥, ä¸”å–å€¼ä¸ºå®æ•°, é‚£ä¹ˆ Sigmoid ä¿¡å¿µç½‘ç»œçš„ç½‘ç»œç»“æ„å’Œ Logistic å›å½’æ¨¡å‹ç±»ä¼¼, å¦‚å›¾11.4æ‰€ç¤º. ä½†æ˜¯, è¿™ä¸¤ä¸ªæ¨¡å‹çš„åŒºåˆ«åœ¨äº, Logistic å›å½’æ¨¡å‹ä¸­çš„ $\boldsymbol{x}$ ä½œä¸ºä¸€ç§ç¡®å®šæ€§çš„å‚æ•°, è€Œéå˜é‡. å› æ­¤, Logistic å›å½’æ¨¡å‹åªå»ºæ¨¡æ¡ä»¶æ¦‚ç‡ $p(y \mid \boldsymbol{x})$, æ˜¯ä¸€ç§åˆ¤åˆ«æ¨¡å‹; è€Œ Sigmoid ä¿¡å¿µç½‘ç»œå»ºæ¨¡è”åˆæ¦‚ç‡ $p(\boldsymbol{x}, y)$, æ˜¯ä¸€ç§ç”Ÿæˆæ¨¡å‹.

![Sigmoidä¿¡å¿µç½‘ç»œå’ŒLogisticå›å½’æ¨¡å‹çš„æ¯”è¾ƒ](.assets/image-20231216150346064.png)

### **æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨**

==æœ´ç´ è´å¶æ–¯ ( Naive Bayes, NB)== åˆ†ç±»å™¨æ˜¯ä¸€ç±»ç®€å•çš„æ¦‚ç‡åˆ†ç±»å™¨, åœ¨å¼º (æœ´ç´  ) ç‹¬ç«‹æ€§å‡è®¾çš„æ¡ä»¶ä¸‹è¿ç”¨è´å¶æ–¯å…¬å¼æ¥è®¡ç®—æ¯ä¸ªç±»åˆ«çš„æ¡ä»¶æ¦‚ç‡.
ç»™å®šä¸€ä¸ªæœ‰ $M$ ç»´ç‰¹å¾çš„æ ·æœ¬ $\boldsymbol{x}$ å’Œç±»åˆ« $y$, ç±»åˆ« $y$ çš„æ¡ä»¶æ¦‚ç‡ä¸º
$$
\begin{aligned}
p(y \mid \boldsymbol{x} ; \theta) & =\frac{p\left(x_1, \cdots, x_M \mid y ; \theta\right) p(y ; \theta)}{p\left(x_1, \cdots, x_M\right)} \\
& \propto p\left(x_1, \cdots, x_M \mid y ; \theta\right) p(y ; \theta),
\end{aligned}
$$


å…¶ä¸­ $\theta$ ä¸ºæ¦‚ç‡åˆ†å¸ƒçš„å‚æ•°.
åœ¨æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ä¸­, å‡è®¾åœ¨ç»™å®š $Y$ çš„æƒ…å†µä¸‹, $X_m$ ä¹‹é—´æ˜¯æ¡ä»¶ç‹¬ç«‹çš„, å³ $X_m \perp X_k \mid Y, \forall m \neq k$. ä¸‹å›¾ç»™å‡ºäº†æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨çš„å›¾æ¨¡å‹è¡¨ç¤º.



![image-20231216150648772](.assets/image-20231216150648772.png)

æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $p(y \mid \boldsymbol{x})$ å¯ä»¥åˆ†è§£ä¸º
$$
p(y \mid x ; \theta) \propto p\left(y \mid \theta_c\right) \prod_{m=1}^M p\left(x_m \mid y ; \theta_m\right),
$$

å…¶ä¸­ $\theta_c$ æ˜¯ $y$ çš„å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒçš„å‚æ•°, $\theta_m$ æ˜¯æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $p\left(x_m \mid y ; \theta_m\right)$ çš„å‚æ•°. è‹¥ $x_m$ ä¸ºè¿ç»­å€¼, $p\left(x_m \mid y ; \theta_m\right)$ å¯ä»¥ç”¨é«˜æ–¯åˆ†å¸ƒå»ºæ¨¡; è‹¥ $x_m$ ä¸ºç¦»æ•£å€¼, $p\left(x_m \mid y ; \theta_m\right)$ å¯ä»¥ç”¨å¤šé¡¹åˆ†å¸ƒå»ºæ¨¡.

è™½ç„¶æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨çš„æ¡ä»¶ç‹¬ç«‹æ€§å‡è®¾å¤ªå¼º, ä½†æ˜¯åœ¨å®é™…åº”ç”¨ä¸­, æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨åœ¨å¾ˆå¤šä»»åŠ¡ä¸Šä¹Ÿèƒ½å¾—åˆ°å¾ˆå¥½çš„ç»“æœ, å¹¶ä¸”æ¨¡å‹ç®€å•, å¯ä»¥æœ‰æ•ˆé˜²æ­¢è¿‡æ‹Ÿåˆ.



### **éšé©¬å°”å¯å¤«æ¨¡å‹**

==éšé©¬å°”å¯å¤«æ¨¡å‹== ( Hidden Markov Model, HMM ) [Baum et al., 1966] æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€ç§å«æœ‰éšå˜é‡çš„é©¬å°”å¯å¤«è¿‡ç¨‹.

å›¾11.6ç»™å‡ºéšé©¬å°”å¯å¤«æ¨¡å‹çš„å›¾æ¨¡å‹è¡¨ç¤º, å…¶ä¸­ $X_{1: T}$ ä¸ºå¯è§‚æµ‹å˜é‡, $Y_{1: T}$ ä¸ºéšå˜é‡. æ‰€æœ‰çš„éšå˜é‡æ„æˆä¸€ä¸ªé©¬å°”å¯å¤«é“¾, æ¯ä¸ªå¯è§‚æµ‹æ ‡é‡ $X_t$ ä¾èµ–å½“å‰æ—¶åˆ»çš„éšå˜é‡ $Y_t$.

éšé©¬å°”å¯å¤«æ¨¡å‹çš„è”åˆæ¦‚ç‡å¯ä»¥åˆ†è§£ä¸º
$$
p(\boldsymbol{x}, \boldsymbol{y} ; \theta)=\prod_{t=1}^T p\left(y_t \mid y_{t-1}, \theta_s\right) p\left(x_t \mid y_t, \theta_t\right),
$$

ä¸ºäº†æè¿°æ–¹ä¾¿, è¿™é‡Œç”¨ $p\left(y_1 \mid y_0\right)$ è¡¨ç¤º $p\left(y_1\right)$.

å…¶ä¸­ $\boldsymbol{x}$ å’Œ $\boldsymbol{y}$ åˆ†åˆ«ä¸ºå¯è§‚æµ‹å˜é‡å’Œéšå˜é‡çš„å–å€¼, æ¡ä»¶æ¦‚ç‡ $p\left(x_t \mid y_t, \theta_t\right)$ ç§°ä¸º==è¾“å‡ºæ¦‚ç‡==, æ¡ä»¶æ¦‚ç‡ $p\left(y_t \mid y_{t-1}, \theta_s\right)$ ç§°ä¸º==è½¬ç§»æ¦‚ç‡==, $\theta_s$ å’Œ $\theta_t$ åˆ†åˆ«è¡¨ç¤ºä¸¤ç±»æ¡ä»¶æ¦‚ç‡çš„å‚æ•°.

## æ— å‘å›¾æ¨¡å‹



==æ— å‘å›¾æ¨¡å‹==ï¼Œä¹Ÿç§°ä¸º==é©¬å°”å¯å¤«éšæœºåœº==ï¼ˆMarkov Random Fieldï¼ŒMRFï¼‰æˆ–é©¬å°”å¯å¤«ç½‘ç»œï¼ˆMarkov Networkï¼‰ï¼Œæ˜¯ä¸€ç±»ç”¨==æ— å‘å›¾==æ¥æè¿°ä¸€ç»„å…·æœ‰å±€éƒ¨é©¬å°”å¯å¤«æ€§è´¨çš„éšæœºå‘é‡ $X$ çš„è”åˆæ¦‚ç‡åˆ†å¸ƒçš„æ¨¡å‹ï¼

:::info å®šä¹‰ï¼ˆé©¬å°”å¯å¤«éšæœºåœºï¼‰

å¯¹äºä¸€ä¸ªéšæœºå‘é‡ $\boldsymbol{X}=\left[X_1, \cdots, X_K\right]^{\top}$ å’Œä¸€ä¸ªæœ‰ $K$ ä¸ªèŠ‚ç‚¹çš„æ— å‘å›¾ $G(\mathcal{V}, \mathcal{E})$ ( å¯ä»¥å­˜åœ¨å¾ªç¯), å›¾ $G$ ä¸­çš„èŠ‚ç‚¹ $k$ è¡¨ç¤ºéšæœºå˜é‡ $X_k, 1 \leq k \leq K$. å¦‚æœ $(G, X)$ æ»¡è¶³å±€éƒ¨é©¬å°”å¯å¤«æ€§è´¨, å³ä¸€ä¸ªå˜é‡ $X_k$ åœ¨ç»™å®šå®ƒçš„é‚»å±…çš„æƒ…å†µä¸‹ç‹¬ç«‹äºæ‰€æœ‰å…¶ä»–å˜é‡,
$$
p\left(x_k \mid \boldsymbol{x}_{\backslash k}\right)=p\left(x_k \mid \boldsymbol{x}_{\mathcal{N}(k)}\right),
$$

å…¶ä¸­ $\mathcal{N}(k)$ ä¸ºå˜é‡ $X_k$ çš„é‚»å±…é›†åˆ, $\backslash k$ ä¸ºé™¤ $X_k$ å¤–å…¶ä»–å˜é‡çš„é›†åˆ, é‚£ä¹ˆ $(G, X)$ å°±æ„æˆäº†ä¸€ä¸ªé©¬å°”å¯å¤«éšæœºåœº.



:::

å‘å›¾ä¸­çš„==å±€éƒ¨é©¬å°”å¯å¤«æ€§è´¨==å¯ä»¥è¡¨ç¤ºä¸º
$$
X_k \perp \boldsymbol{X}_{\backslash\mathcal{N}(k), \backslash k} \mid \boldsymbol{X}_{\mathcal{N}(k)},
$$

å…¶ä¸­ $\boldsymbol{X}_{ \backslash\mathcal{N}(k),\backslash k}$ è¡¨ç¤ºé™¤ $\boldsymbol{X}_{\mathcal{N}(k)}$ å’Œ $X_k$ å¤–çš„å…¶ä»–å˜é‡.
å¯¹äºå›¾ä¸­çš„ $4$ ä¸ªå˜é‡, æ ¹æ®é©¬å°”å¯å¤«æ€§è´¨, å¯ä»¥å¾—åˆ° $X_1 \perp X_4 \mid X_2, X_3$ å’Œ $X_2 \perp X_3 \mid X_1, X_4$

![image-20231216152932251](.assets/image-20231216152932251.png)



### **æ— å‘å›¾æ¨¡å‹çš„æ¦‚ç‡åˆ†è§£**

::: info å›¢

ç”±äºæ— å‘å›¾æ¨¡å‹å¹¶ä¸æä¾›ä¸€ä¸ªå˜é‡çš„æ‹“æ‰‘é¡ºåº, å› æ­¤æ— æ³•ç”¨é“¾å¼æ³•åˆ™å¯¹ $p(x)$ è¿›è¡Œé€ä¸€åˆ†è§£. æ— å‘å›¾æ¨¡å‹çš„è”åˆæ¦‚ç‡ä¸€èˆ¬ä»¥å…¨è¿é€šå­å›¾ä¸ºå•ä½è¿›è¡Œåˆ†è§£.æ— å‘å›¾ä¸­çš„ä¸€ä¸ªå…¨è¿é€šå­å›¾, ç§°ä¸ºå›¢ (Clique), å³å›¢å†…çš„æ‰€æœ‰èŠ‚ç‚¹ä¹‹é—´éƒ½è¿è¾¹.åœ¨ä¸‹å›¾æ‰€ç¤ºçš„æ— å‘å›¾ä¸­å…±æœ‰ 7 ä¸ªå›¢, åŒ…æ‹¬ $\left\{X_1, X_2\right\},\left\{X_1, X_3\right\},\left\{X_2, X_3\right\},\left\{X_3, X_4\right\}$, $\left\{X_2, X_4\right\},\left\{X_1, X_2, X_3\right\},\left\{X_2, X_3, X_4\right\}$.

åœ¨æ‰€æœ‰å›¢ä¸­, å¦‚æœä¸€ä¸ªå›¢ä¸èƒ½è¢«å…¶ä»–çš„å›¢åŒ…å«, è¿™ ä¸ªå›¢å°±æ˜¯ä¸€ä¸ª==æœ€å¤§å›¢== ( Maximal Clique).

:::

![image-20231216153149245](.assets/image-20231216153149245.png)

æ— å‘å›¾ä¸­çš„è”åˆæ¦‚ç‡å¯ä»¥åˆ†è§£ä¸ºä¸€ç³»åˆ—å®šä¹‰åœ¨æœ€å¤§å›¢ä¸Šçš„éè´Ÿå‡½æ•°çš„ä¹˜ç§¯å½¢å¼ï¼



::: important Hammersley-Cliffordå®šç†

å¦‚æœä¸€ä¸ªåˆ†å¸ƒ $p(\boldsymbol{x})>0$ æ»¡è¶³æ— å‘å›¾ $G$ ä¸­çš„å±€éƒ¨é©¬å°”å¯å¤«æ€§è´¨, å½“ä¸”ä»…å½“ $p(\boldsymbol{x})$ å¯ä»¥è¡¨ç¤ºä¸ºä¸€ç³»åˆ—å®šä¹‰åœ¨æœ€å¤§å›¢ä¸Šçš„éè´Ÿå‡½æ•°çš„ä¹˜ç§¯å½¢å¼, å³
$$
\begin{equation}
\label{gibbs}
p(\boldsymbol{x})=\frac{1}{Z} \prod_{c \in \mathcal{C}} \phi_c\left(\boldsymbol{x}_c\right),
\end{equation}
$$

å…¶ä¸­ $\mathcal{C}$ ä¸º $G$ ä¸­çš„æœ€å¤§å›¢é›†åˆ, $\phi_c\left(\boldsymbol{x}_c\right) \geq 0$ æ˜¯å®šä¹‰åœ¨å›¢ $c$ ä¸Šçš„==åŠ¿èƒ½å‡½æ•°== (Potential Function ), $Z$ æ˜¯==é…åˆ†å‡½æ•°== (Partition Function), ç”¨æ¥å°†ä¹˜ç§¯å½’ä¸€åŒ–ä¸ºæ¦‚ç‡å½¢å¼:
$$
Z=\sum_{x \in X} \prod_{c \in \mathcal{C}} \phi_c\left(\boldsymbol{x}_c\right)
$$

å…¶ä¸­ $x$ ä¸ºéšæœºå‘é‡ $X$ çš„å–å€¼ç©ºé—´.

:::

Hammersley-Clifford å®šç†çš„è¯æ˜å¯ä»¥å‚è€ƒ [^2]ï¼æ— å‘å›¾æ¨¡å‹ä¸æœ‰å‘å›¾æ¨¡å‹çš„ä¸€ä¸ªé‡è¦åŒºåˆ«æ˜¯æœ‰é…åˆ†å‡½æ•°ğ‘ï¼é…åˆ†å‡½æ•°çš„è®¡ç®—å¤æ‚åº¦æ˜¯æŒ‡æ•°çš„ï¼Œå› æ­¤åœ¨æ¨æ–­å’Œå‚æ•°å­¦ä¹ æ—¶éƒ½éœ€è¦é‡ç‚¹è€ƒè™‘ï¼

::: info å‰å¸ƒæ–¯åˆ†å¸ƒ

å…¬å¼ $\ref{gibbs}$ ä¸­å®šä¹‰çš„åˆ†å¸ƒå½¢å¼ä¹Ÿç§°ä¸ºå‰å¸ƒæ–¯åˆ†å¸ƒï¼ˆGibbs Distributionï¼‰ï¼æ ¹æ® Hammersley-Clifford å®šç†ï¼Œæ— å‘å›¾æ¨¡å‹å’Œå‰å¸ƒæ–¯åˆ†å¸ƒæ˜¯ä¸€è‡´çš„ï¼å‰å¸ƒæ–¯åˆ†å¸ƒä¸€å®šæ»¡è¶³é©¬å°”å¯å¤«éšæœºåœºçš„æ¡ä»¶ç‹¬ç«‹æ€§è´¨ï¼Œå¹¶ä¸”é©¬å°”å¯å¤«éšæœºåœºçš„æ¦‚ç‡åˆ†å¸ƒä¸€å®šå¯ä»¥è¡¨ç¤ºæˆå‰å¸ƒæ–¯åˆ†å¸ƒï¼

:::

ç”±äºåŠ¿èƒ½å‡½æ•°å¿…é¡»ä¸ºæ­£,å› æ­¤æˆ‘ä»¬ä¸€èˆ¬å®šä¹‰ä¸º
$$
\phi_c\left(\boldsymbol{x}_c\right)=\exp \left(-E_c\left(\boldsymbol{x}_c\right)\right),
$$

å…¶ä¸­ $E_c\left(\boldsymbol{x}_c\right)$ ä¸º==èƒ½é‡å‡½æ•°== (Energy Function).

å› æ­¤,æ— å‘å›¾ä¸Šå®šä¹‰çš„æ¦‚ç‡åˆ†å¸ƒå¯ä»¥è¡¨ç¤ºä¸º
$$
\begin{equation}
\label{boltz}
\begin{aligned}
P(\boldsymbol{x}) & =\frac{1}{Z} \prod_{c \in \mathcal{C}} \exp \left(-E_c\left(\boldsymbol{x}_c\right)\right) \\
& =\frac{1}{Z} \exp \left(\sum_{c \in \mathcal{C}}-E_c\left(\boldsymbol{x}_c\right)\right) .
\end{aligned}
\end{equation}
$$

è¿™ç§å½¢å¼çš„åˆ†å¸ƒåˆç§°ä¸ºç»å°”å…¹æ›¼åˆ†å¸ƒ (Boltzmann Distribution). ä»»ä½•ä¸€ä¸ªæ— å‘å›¾æ¨¡å‹éƒ½å¯ä»¥ç”¨å…¬å¼ $\ref{boltz}$ æ¥è¡¨ç¤ºå…¶è”åˆæ¦‚ç‡.

## å¸¸è§çš„æ— å‘å›¾æ¨¡å‹

å¾ˆå¤šç»å…¸çš„æœºå™¨å­¦ä¹ æ¨¡å‹å¯ä»¥ä½¿ç”¨æ— å‘å›¾æ¨¡å‹æ¥æè¿°ï¼Œæ¯”å¦‚å¯¹æ•°çº¿æ€§æ¨¡å‹ï¼ˆä¹Ÿå«æœ€å¤§ç†µæ¨¡å‹ï¼‰ã€æ¡ä»¶éšæœºåœºã€ç»å°”å…¹æ›¼æœºã€å—é™ç»å°”å…¹æ›¼æœºç­‰ï¼

### å¯¹æ•°çº¿æ€§æ¨¡å‹

åŠ¿èƒ½å‡½æ•°ä¸€èˆ¬å®šä¹‰ä¸º
$$
\phi_c\left(\boldsymbol{x}_c \mid \theta_c\right)=\exp \left(\theta_c^{\top} f_c\left(\boldsymbol{x}_c\right)\right),
$$

å…¶ä¸­å‡½æ•° $f_c\left(\boldsymbol{x}_c\right)$ ä¸ºå®šä¹‰åœ¨ $\boldsymbol{x}_c$ ä¸Šçš„ç‰¹å¾å‘é‡, $\theta_c$ ä¸ºæƒé‡å‘é‡. è¿™æ ·è”åˆæ¦‚ç‡ $p(\boldsymbol{x})$çš„å¯¹æ•°å½¢å¼ä¸º
$$
\log p(\boldsymbol{x} ; \theta)=\sum_{c \in \mathcal{C}} \theta_c^{\top} f_c\left(\boldsymbol{x}_c\right)-\log Z(\theta),
$$

å…¶ä¸­ $\theta$ ä»£è¡¨æ‰€æœ‰åŠ¿èƒ½å‡½æ•°ä¸­çš„å‚æ•° $\theta_c$. è¿™ç§å½¢å¼çš„æ— å‘å›¾æ¨¡å‹ä¹Ÿç§°ä¸ºå¯¹æ•°çº¿æ€§æ¨¡å‹ ( Log-Linear Model) æˆ–æœ€å¤§ç†µæ¨¡å‹ (Maximum Entropy Model) [Berger et al., 1996; Della Pietra et al., 1997]. å›¾11.8aæ‰€ç¤ºæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æœ€å¤§ç†µæ¨¡å‹.
å¦‚æœç”¨å¯¹æ•°çº¿æ€§æ¨¡å‹æ¥å»ºæ¨¡æ¡ä»¶æ¦‚ç‡ $p(y \mid \boldsymbol{x})$,
$$
p(y \mid \boldsymbol{x} ; \theta)=\frac{1}{Z(\boldsymbol{x} ; \theta)} \exp \left(\theta^{\top} f(\boldsymbol{x}, y)\right),
$$

å…¶ä¸­ $Z(\boldsymbol{x} ; \theta)=\sum_y \exp \left(\theta^{\top} f_{\boldsymbol{y}}(\boldsymbol{x}, y)\right)$.
å¯¹æ•°çº¿æ€§æ¨¡å‹ä¹Ÿç§°ä¸ºæ¡ä»¶æœ€å¤§ç†µæ¨¡å‹æˆ–Softmax å›å½’æ¨¡å‹.

### æ¡ä»¶éšæœºåœº

## æœ‰å‘å›¾å’Œæ— å‘å›¾ç›´æ¥çš„è½¬æ¢



## å‚è€ƒ

[^1]: [PII: 0004-3702(92)90065-6 (toronto.edu)](https://www.cs.toronto.edu/~bonner/courses/2016s/csc321/readings/Connectionist learning of belief networks.pdf)
[^2]: Koller D, Friedman N, 2009. Probabilistic graphical models: principles and techniques[M]. MITpress.

